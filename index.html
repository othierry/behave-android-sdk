<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Behave-java-sdk by othierry</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Behave-java-sdk</h1>
        <p class="header">Behave Java SDK</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/othierry/behave-android-sdk/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/othierry/behave-android-sdk/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/othierry/behave-android-sdk">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/othierry">othierry</a></p>


      </header>
      <section>
        <h1>
<a name="introduction" class="anchor" href="#introduction"><span class="octicon octicon-link"></span></a>Introduction</h1>

<p>Our Java library lets you easily identify your users, track their behaviours, handle rewards and make full use of the API.</p>

<ol>
<li>
<a href="#getting-started">Getting started</a>

<ul>
<li><a href="#adding-your-api-token-to-your-settings">Adding your API token to your settings</a></li>
<li><a href="#initializing-the-sdk">Initializing the SDK</a></li>
</ul>
</li>
<li>
<a href="#players">Players</a>

<ul>
<li><a href="#identify">Identify</a></li>
<li><a href="#retrieve-a-player">Retrieve a player</a></li>
</ul>
</li>
<li>
<a href="#behaviours">Behaviours</a>

<ul>
<li><a href="#simple-tracking">Simple tracking</a></li>
<li><a href="#contextual-tracking">Contextual tracking</a></li>
<li><a href="#using-the-tracking-response">Using the tracking response</a></li>
</ul>
</li>
<li>
<a href="#leaderboards">Leaderboards</a>

<ul>
<li><a href="#getting-leaderboard-current-results">Getting leaderboard results</a></li>
<li><a href="#getting-leaderboard-results-for-the-currently-identified-player">Getting leaderboard results for a player</a></li>
</ul>
</li>
<li>
<a href="#badges">Badges</a>

<ul>
<li><a href="#getting-unlocked-badges-of-the-currently-identified-player">Getting unlocked badges of a player</a></li>
<li><a href="#getting-locked-badges-of-the-currently-identified-player">Getting locked badges of a player</a></li>
</ul>
</li>
<li>
<a href="#listeners">Listeners</a>

<ul>
<li><a href="#adding-a-listener">Adding a listener</a></li>
<li><a href="#removing-a-listener">Removing a listener</a></li>
</ul>
</li>
</ol><h2>
<a name="getting-started" class="anchor" href="#getting-started"><span class="octicon octicon-link"></span></a>Getting started</h2>

<p>You can find the API token <a href="http://dashboard.behave.io/#/settings" target="_blank">from your dashboard in your app settings</a>.</p>

<h3>
<a name="adding-your-api-token-to-your-settings" class="anchor" href="#adding-your-api-token-to-your-settings"><span class="octicon octicon-link"></span></a>Adding your API token to your settings</h3>

<p>Edit the xml <code>res/values/string.xml</code> and add the following entry:</p>

<div class="highlight highlight-html"><pre><span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">"behave_api_token"</span><span class="nt">&gt;</span>YOUR_API_TOKEN_HERE<span class="nt">&lt;/string&gt;</span>
</pre></div>

<h3>
<a name="initializing-the-sdk" class="anchor" href="#initializing-the-sdk"><span class="octicon octicon-link"></span></a>Initializing the SDK</h3>

<p>Before starting to do anything, you first need to initialize the SDK with a valid Context Object.</p>

<p>For example in your main Activty onCreate() method, you would do the following (example)</p>

<div class="highlight highlight-java"><pre><span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
  <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>

  <span class="c1">// Initialize behave</span>
  <span class="n">Behave</span> <span class="n">behave</span> <span class="o">=</span> <span class="n">Behave</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="k">this</span><span class="o">);</span> <span class="c1">// or directly Behave.getInstance(this.getApplicationContext());</span>
  <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>

<p>After you have initialized Behave with a valid Context, you can simply do the following in the rest of your application.</p>

<div class="highlight highlight-java"><pre><span class="n">Behave</span> <span class="n">behave</span> <span class="o">=</span> <span class="n">Behave</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
</pre></div>

<h2>
<a name="players" class="anchor" href="#players"><span class="octicon octicon-link"></span></a>Players</h2>

<h3>
<a name="identify" class="anchor" href="#identify"><span class="octicon octicon-link"></span></a>Identify</h3>

<p>You need to identify your users at least once so their player profiles can be created. You can optionally attribute some traits to the player that you can update/retrieve at any time.</p>

<p>The identified Player can be retrieved using <code>Behave.getInstance().getPlayer()</code></p>

<ul>
<li>
<strong>Method (instance method):</strong> </li>
</ul><div class="highlight highlight-java"><pre><span class="n">Behave</span><span class="o">.</span><span class="na">identify</span><span class="o">(</span>
  <span class="n">String</span> <span class="n">referenceId</span><span class="o">,</span> 
  <span class="o">[</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">traits</span><span class="o">],</span> 
  <span class="o">[</span><span class="n">BehaveApiCallback</span><span class="o">&lt;</span><span class="n">Player</span><span class="o">&gt;</span> <span class="n">callback</span><span class="o">]</span>
<span class="o">)</span> 
</pre></div>

<ul>
<li><strong>Parameters:</strong></li>
</ul><table>
<thead><tr>
<th>Name</th>
<th align="center">Type</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr>
<td>referenceId</td>
<td align="center">String</td>
<td align="right">
<strong>(Required)</strong> The id of the player in YOUR database</td>
</tr>
<tr>
<td>traits</td>
<td align="center">Map</td>
<td align="right">
<strong>(optional)</strong> The custom traits you assign to the player. You can use any key-value pair to give attributes to the player. The 2 special fields: <code>name</code> and <code>picture</code> will be used as display information from the admin interface. We recommend to specify them if you can.</td>
</tr>
<tr>
<td>callback</td>
<td align="center">BehaveApiCallback</td>
<td align="right">
<strong>(optional)</strong> A callback implementation</td>
</tr>
</tbody>
</table><p>Example:</p>

<div class="highlight highlight-java"><pre><span class="c1">// Sample traits</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">traits</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">traits</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="s">"Olivier"</span><span class="o">);</span>
<span class="n">traits</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"picture"</span><span class="o">,</span> <span class="s">"https://path_to_picture"</span><span class="o">);</span>
<span class="n">traits</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"email"</span><span class="o">,</span> <span class="s">"olivier@behave.io"</span><span class="o">);</span>
<span class="n">traits</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"foo"</span><span class="o">,</span> <span class="s">"bar"</span><span class="o">);</span>

<span class="n">Behave</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">identify</span><span class="o">(</span><span class="s">"42"</span><span class="o">,</span> <span class="n">traits</span><span class="o">,</span> <span class="k">new</span> <span class="n">BehaveApiCallback</span><span class="o">&lt;</span><span class="n">Player</span><span class="o">&gt;()</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">Player</span> <span class="n">player</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Use either player or Behave.getInstance().getPlayer()</span>
  <span class="o">}</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Error</span> <span class="n">error</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Handle error</span>
  <span class="o">}</span>
<span class="o">});</span>
</pre></div>

<p>A player has the following members with associated getters:</p>

<table>
<thead><tr>
<th>Name</th>
<th align="center">Type</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr>
<td>id</td>
<td align="center">String</td>
<td align="right">The id of the Player</td>
</tr>
<tr>
<td>referenceId</td>
<td align="center">String</td>
<td align="right">The custom unique id you have specified to identify this player</td>
</tr>
<tr>
<td>points</td>
<td align="center">int</td>
<td align="right">The number of points of the player (default to 0)</td>
</tr>
<tr>
<td>level</td>
<td align="center">Level</td>
<td align="right">The current level of the player (and its progress), null otherwise.</td>
</tr>
<tr>
<td>traits</td>
<td align="center">Map</td>
<td align="right">The custom traits you have given to the player</td>
</tr>
</tbody>
</table><p><strong>NOTE:</strong> The player will load asynchronously so calling <code>behave.getInstance().getPlayer()</code> right after <code>behave.getInstance().identify()</code> will return the right Player object but its points, level and traits may not have loaded yet. Your app can easily listen to events to have control when the player has been fully identified (loaded) and more. Please refer to <a href="#listeners">Listeners</a> for more information.</p>

<h3>
<a name="retrieve-a-player" class="anchor" href="#retrieve-a-player"><span class="octicon octicon-link"></span></a>Retrieve a player</h3>

<p>Sometimes you want to retrieve a player's profile without having to identify() him, you can easily by using the <code>fetch()</code> instance method of the Player class.</p>

<ul>
<li>
<strong>Method (instance method):</strong> </li>
</ul><div class="highlight highlight-java"><pre><span class="n">Player</span><span class="o">.</span><span class="na">fetch</span><span class="o">(</span>
  <span class="n">BehaveApiCallback</span><span class="o">&lt;</span><span class="n">Player</span><span class="o">&gt;</span>
<span class="o">)</span>
</pre></div>

<ul>
<li><strong>Parameters:</strong></li>
</ul><table>
<thead><tr>
<th>Name</th>
<th align="center">Type</th>
<th align="right">Value</th>
</tr></thead>
<tbody><tr>
<td>callback</td>
<td align="center">BehaveApiCallback</td>
<td align="right">
<strong>(required)</strong> a callback implementation</td>
</tr></tbody>
</table><p>Example:</p>

<div class="highlight highlight-java"><pre><span class="n">Player</span> <span class="n">player</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Player</span><span class="o">(</span><span class="s">"42"</span><span class="o">);</span>
<span class="n">player</span><span class="o">.</span><span class="na">fetch</span><span class="o">(</span><span class="k">new</span> <span class="n">BehaveApiCallback</span><span class="o">&lt;</span><span class="n">Player</span><span class="o">&gt;()</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">Player</span> <span class="n">player</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Use the player. The player passed as argument is the SAME object as the one defined above. </span>
    <span class="c1">// This just avoids having to use final keyword everywhere</span>
  <span class="o">}</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Error</span> <span class="n">error</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Handle error</span>
  <span class="o">}</span>
<span class="o">})</span>
</pre></div>

<h2>
<a name="behaviours" class="anchor" href="#behaviours"><span class="octicon octicon-link"></span></a>Behaviours</h2>

<p>You need to track your players behaviours if you want to reward them for doing so! Tracking can be either <strong>simple</strong> or <strong>contextual</strong>. You can specify ANY key value pairs to describe the context to which the behaviour was taken (See examples below):</p>

<ul>
<li>
<strong>Method (instance method):</strong> </li>
</ul><div class="highlight highlight-java"><pre><span class="n">Behave</span><span class="o">.</span><span class="na">track</span><span class="o">(</span>
  <span class="n">String</span> <span class="n">behaviour</span><span class="o">,</span> 
  <span class="o">[</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">context</span><span class="o">],</span> 
  <span class="o">[</span><span class="n">BehaveApiCallback</span><span class="o">&lt;</span><span class="n">TrackResult</span><span class="o">&gt;</span> <span class="n">callback</span><span class="o">]</span>
<span class="o">)</span>
</pre></div>

<ul>
<li><strong>Parameters:</strong></li>
</ul><table>
<thead><tr>
<th>Name</th>
<th align="center">Type</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr>
<td>behaviour</td>
<td align="center">String</td>
<td align="right">
<strong>(Required)</strong> The name of the behaviour you are tracking</td>
</tr>
<tr>
<td>context</td>
<td align="center">Map</td>
<td align="right">
<strong>(optional)</strong> You can specify ANY key value pairs to describe the context to which the behaviour was taken. Optionally, A special field <code>timestamp</code> <strong>(unix timestamp)</strong> defines when was this behaviour taken. <strong>Make sure you specify a timestamp when importing data</strong>. We will use the server's current time by default.</td>
</tr>
<tr>
<td>callback</td>
<td align="center">BehaveApiCallback</td>
<td align="right">
<strong>(optional)</strong> a callback implementation</td>
</tr>
</tbody>
</table><p><strong>NOTE:</strong> Your app can easily listen to reward events to have control when the player has earned points, unlocked badges and more. Please refer to <a href="#listeners">Listeners</a> for more information.</p>

<h3>
<a name="simple-tracking" class="anchor" href="#simple-tracking"><span class="octicon octicon-link"></span></a>Simple tracking</h3>

<div class="highlight highlight-java"><pre><span class="n">Behave</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">track</span><span class="o">(</span><span class="s">"login"</span><span class="o">);</span>
</pre></div>

<h3>
<a name="contextual-tracking" class="anchor" href="#contextual-tracking"><span class="octicon octicon-link"></span></a>Contextual tracking</h3>

<div class="highlight highlight-java"><pre><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">context</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"placeId"</span><span class="o">,</span> <span class="s">"432442"</span><span class="o">);</span>
<span class="n">context</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"withMates"</span><span class="o">,</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"324"</span><span class="o">,</span> <span class="s">"923"</span><span class="o">,</span> <span class="s">"31236"</span><span class="o">));</span>

<span class="n">Behave</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">track</span><span class="o">(</span><span class="s">"check-in"</span><span class="o">,</span> <span class="n">context</span><span class="o">);</span>
</pre></div>

<h3>
<a name="using-the-tracking-response" class="anchor" href="#using-the-tracking-response"><span class="octicon octicon-link"></span></a>Using the tracking response</h3>

<p>When you track a user behaviour, you get back a response of basically what happened. The response contains the rewards that the tracking has triggered (from your <a href="http://dashboard.behave.io/recipes">recipes</a>).</p>

<p>The response <strong>always contains 3 methods</strong>.</p>

<table>
<thead><tr>
<th>Name</th>
<th align="center">Return type</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr>
<td>getBadges()</td>
<td align="center">Array[Badge]</td>
<td align="right">The unlocked badges</td>
</tr>
<tr>
<td>getPoints()</td>
<td align="center">Points</td>
<td align="right">With 2 methods: <code>getEarned()</code> and <code>getBalance()</code>. <code>getEarned()</code> is the number of points the user earned by taking the action or 0 if no points earned, <code>getBalance()</code> is the updated balance of the player points</td>
</tr>
<tr>
<td>getLevel()</td>
<td align="center">Level</td>
<td align="right">The current level of the player, null otherwise.</td>
</tr>
</tbody>
</table><p>Behave SDK will publish events when player is identified, when badges are unlocked, when a level is reached and more. Refer to <a href="#listeners">Listeners</a> for more information</p>

<p>Example:</p>

<div class="highlight highlight-java"><pre><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">context</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"placeId"</span><span class="o">,</span> <span class="s">"432442"</span><span class="o">);</span>
<span class="n">context</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"withMates"</span><span class="o">,</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"324"</span><span class="o">,</span> <span class="s">"923"</span><span class="o">,</span> <span class="s">"31236"</span><span class="o">));</span>


<span class="n">Behave</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">track</span><span class="o">(</span><span class="s">"check-in"</span><span class="o">,</span> <span class="n">context</span><span class="o">,</span> <span class="k">new</span> <span class="n">BehaveApiCallback</span><span class="o">&lt;</span><span class="n">TrackResult</span><span class="o">&gt;()</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">TrackResult</span> <span class="n">trackResult</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Use trackResult</span>
    <span class="c1">// trackResult.getPoints().getEarned()</span>
    <span class="c1">// trackResult.getPoints().getBalance()</span>
    <span class="c1">// trackResult.getBadges()</span>
    <span class="c1">// trackResult.getLevel().getProgress()</span>
    <span class="c1">// trackResult.getLevel().isNew() (will be true when did just level up)</span>
    <span class="c1">// ...</span>
  <span class="o">}</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Error</span> <span class="n">error</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Handle error</span>
  <span class="o">}</span>
<span class="o">});</span>
</pre></div>

<h2>
<a name="leaderboards" class="anchor" href="#leaderboards"><span class="octicon octicon-link"></span></a>Leaderboards</h2>

<p><strong>Note:</strong> If you want to test you leaderboard results, you can directly use <a href="http://dashboard.behave.io/#/simulator">the built-in simulator</a> to test API calls.</p>

<h3>
<a name="getting-leaderboard-current-results" class="anchor" href="#getting-leaderboard-current-results"><span class="octicon octicon-link"></span></a>Getting leaderboard current results</h3>

<p>You can fetch the actual results of any leaderboard at anytime. Here is an example:</p>

<ul>
<li>
<strong>Method (instance method):</strong> </li>
</ul><div class="highlight highlight-java"><pre><span class="n">Leaderboard</span><span class="o">.</span><span class="na">fetchResults</span><span class="o">(</span>
  <span class="o">[</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">options</span><span class="o">],</span> 
  <span class="n">BehaveApiCallback</span><span class="o">&lt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">LeaderboardScore</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">callback</span>
<span class="o">)</span>
</pre></div>

<ul>
<li><strong>Parameters:</strong></li>
</ul><table>
<thead><tr>
<th>Name</th>
<th align="center">Type</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr>
<td>options</td>
<td align="center">Map</td>
<td align="right">
<strong>(Optional)</strong> Result fetching options</td>
</tr>
<tr>
<td>options</td>
<td align="center">BehaveApiCallback&lt; List &gt;</td>
<td align="right">
<strong>(Required)</strong> a callback implementation</td>
</tr>
</tbody>
</table><p>Example</p>

<div class="highlight highlight-java"><pre><span class="c1">// We want to fetch the top 500</span>
<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">options</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">options</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"limit"</span><span class="o">,</span> <span class="mi">500</span><span class="o">);</span>

<span class="n">Leaderboard</span> <span class="n">leaderboard</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Leaderboard</span><span class="o">(</span><span class="s">"points"</span><span class="o">);</span>
<span class="n">leaderboard</span><span class="o">.</span><span class="na">fetchResults</span><span class="o">(</span><span class="n">options</span><span class="o">,</span> <span class="k">new</span> <span class="n">BehaveApiCallback</span><span class="o">&lt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">LeaderboardScore</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">LeaderboardScore</span><span class="o">&gt;</span> <span class="n">results</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Use results</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">LeaderboardScore</span> <span class="n">score</span> <span class="o">:</span> <span class="n">results</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">"BehaveExample"</span><span class="o">,</span> <span class="s">"[Position] "</span> <span class="o">+</span> <span class="n">score</span><span class="o">.</span><span class="na">getPosition</span><span class="o">()</span> <span class="o">+</span> 
                          <span class="s">" | [Score] "</span>    <span class="o">+</span> <span class="n">score</span><span class="o">.</span><span class="na">getScore</span><span class="o">()</span> <span class="o">+</span> 
                          <span class="s">" | [Player] "</span>   <span class="o">+</span> <span class="n">score</span><span class="o">.</span><span class="na">getPlayer</span><span class="o">().</span><span class="na">getReferenceId</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Error</span> <span class="n">error</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Handle error</span>
  <span class="o">}</span>  
<span class="o">});</span>
</pre></div>

<p>Available options are:</p>

<table>
<thead><tr>
<th>Name</th>
<th align="center">Type</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr>
<td>page</td>
<td align="center">int</td>
<td align="right">(Optional) The results page to fetch. Default is 1</td>
</tr>
<tr>
<td>limit</td>
<td align="center">int</td>
<td align="right">(Optional) The max number of results per page. MAXIMUM is 1000</td>
</tr>
<tr>
<td>offset</td>
<td align="center">int</td>
<td align="right">(Optional) The maximum position to fetch, default is 0 =&gt; None</td>
</tr>
<tr>
<td>player_id</td>
<td align="center">String</td>
<td align="right">A player's reference_id (Optional). If specified, the given player will ALWAYS appear in the results (not duplicated). It is very useful if for example you want to always include the current player in the results</td>
</tr>
<tr>
<td>players</td>
<td align="center">Array[String]</td>
<td align="right">(Optional) The players to include in the results, default is null =&gt; ALL</td>
</tr>
<tr>
<td>positions</td>
<td align="center">String</td>
<td align="right">(Optional) The way positions are calculated. Possible values are <code>relative</code> and <code>absolute</code>. <code>relative</code> will set the positions according to the players that are included in the results, <code>absolute</code> will set the positions according to all the players in the leaderboards. This is useful when for example you want to fetch the results for a player and his friends only. In this situation you could pass <code>relative</code> so that the positions are computed between friends and not between all the players in the leaderboards.</td>
</tr>
<tr>
<td>context</td>
<td align="center">Map</td>
<td align="right">(Optional) You can segment results according to a specific context. For example, on a leaderboard with <code>all-time</code> timeframe, if you want to get the results of weeks 42 only you could have <code>{ timestamp: '&gt;=1381701600,&lt;1382306400' }</code>. You can also use any custom key you have specified in the context when tracking behaviours using <code>track()</code>.  <strong>On large leaderboards this can have an impact on performances.</strong>
</td>
</tr>
</tbody>
</table><h3>
<a name="getting-leaderboard-results-for-a-player" class="anchor" href="#getting-leaderboard-results-for-a-player"><span class="octicon octicon-link"></span></a>Getting leaderboard results for a player</h3>

<p>You can also fetch results for a particular player. Let's say you want to fetch the results of a player on one, many or even ALL the leaderboards <strong>the player is in</strong> then you can use this to do so.</p>

<ul>
<li>
<strong>Method (instance method):</strong> </li>
</ul><div class="highlight highlight-java"><pre><span class="n">Player</span><span class="o">.</span><span class="na">fetchLeaderboardResults</span><span class="o">(</span>
  <span class="o">[</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">options</span><span class="o">],</span>
  <span class="n">BehaveApiCallback</span><span class="o">&lt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">LeaderboardScore</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">callback</span>
<span class="o">)</span>
</pre></div>

<ul>
<li>
<strong>Parameters:</strong> </li>
</ul><table>
<thead><tr>
<th>Name</th>
<th align="center">Type</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr>
<td>options</td>
<td align="center">Map</td>
<td align="right">
<strong>(Optional)</strong> Result fetching options</td>
</tr>
<tr>
<td>callback</td>
<td align="center">BehaveApiCallback&lt; List &gt;</td>
<td align="right">
<strong>(Required)</strong> A callback implementation</td>
</tr>
</tbody>
</table><p>Available options are:</p>

<table>
<thead><tr>
<th>Name</th>
<th align="center">Type</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr>
<td>leaderboards</td>
<td align="center">Array[String]</td>
<td align="right">(Optional) Leaderboards to process, if empty all the leaderboards will be processed.</td>
</tr>
<tr>
<td>max</td>
<td align="center">Number</td>
<td align="right">(Optional) The maximum player position acceptance for the leaderboard to be selected.</td>
</tr>
</tbody>
</table><p>Example:</p>

<div class="highlight highlight-java"><pre><span class="n">Player</span> <span class="n">player</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Player</span><span class="o">(</span><span class="s">"42"</span><span class="o">);</span>
<span class="c1">// OR if we want for the current player</span>
<span class="n">Player</span> <span class="n">player</span> <span class="o">=</span> <span class="n">Behave</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">getPlayer</span><span class="o">()</span>

<span class="n">player</span><span class="o">.</span><span class="na">fetchLeaderboardResults</span><span class="o">(</span><span class="k">new</span> <span class="n">BehaveApiCallback</span><span class="o">&lt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">LeaderboardScore</span><span class="o">&gt;</span> <span class="o">&gt;()</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">LeaderboardScore</span><span class="o">&gt;</span> <span class="n">results</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Use results</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">LeaderboardScore</span> <span class="n">score</span> <span class="o">:</span> <span class="n">results</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">"BehaveExample"</span><span class="o">,</span> <span class="s">"[Position] "</span>    <span class="o">+</span> <span class="n">score</span><span class="o">.</span><span class="na">getPosition</span><span class="o">()</span> <span class="o">+</span> 
                          <span class="s">" | [Score] "</span>       <span class="o">+</span> <span class="n">score</span><span class="o">.</span><span class="na">getScore</span><span class="o">()</span> <span class="o">+</span> 
                          <span class="s">" | [Leaderboard] "</span> <span class="o">+</span> <span class="n">score</span><span class="o">.</span><span class="na">getLeaderboard</span><span class="o">().</span><span class="na">getReferenceId</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Error</span> <span class="n">error</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Handle error</span>
  <span class="o">}</span>  
<span class="o">});</span>
</pre></div>

<p>For example, if I want to fetch all the leaderboard results for player where he/she is in the top 3:</p>

<div class="highlight highlight-java"><pre><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">options</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;();</span>
<span class="n">options</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"max"</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>

<span class="n">Behave</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">getPlayer</span><span class="o">().</span><span class="na">fetchLeaderboardResults</span><span class="o">(</span><span class="n">options</span><span class="o">,</span> <span class="k">new</span> <span class="n">BehaveApiCallback</span><span class="o">&lt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">LeaderboardScore</span><span class="o">&gt;</span> <span class="o">&gt;()</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">LeaderboardScore</span><span class="o">&gt;</span> <span class="n">results</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Use results</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">LeaderboardScore</span> <span class="n">score</span> <span class="o">:</span> <span class="n">results</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">"BehaveExample"</span><span class="o">,</span> <span class="s">"[Position] "</span>    <span class="o">+</span> <span class="n">score</span><span class="o">.</span><span class="na">getPosition</span><span class="o">()</span> <span class="o">+</span> 
                          <span class="s">" | [Score] "</span>       <span class="o">+</span> <span class="n">score</span><span class="o">.</span><span class="na">getScore</span><span class="o">()</span> <span class="o">+</span> 
                          <span class="s">" | [Leaderboard] "</span> <span class="o">+</span> <span class="n">score</span><span class="o">.</span><span class="na">getLeaderboard</span><span class="o">().</span><span class="na">getReferenceId</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Error</span> <span class="n">error</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Handle error</span>
  <span class="o">}</span>  
<span class="o">});</span>
</pre></div>

<h3>
<a name="getting-a-single-leaderboard-result-for-a-player" class="anchor" href="#getting-a-single-leaderboard-result-for-a-player"><span class="octicon octicon-link"></span></a>Getting a single leaderboard result for a player</h3>

<p>You can also fetch the current result of a player on just one specific leaderboard</p>

<ul>
<li>
<strong>Method (instance method):</strong> </li>
</ul><div class="highlight highlight-java"><pre><span class="n">Player</span><span class="o">.</span><span class="na">fetchLeaderboardResult</span><span class="o">(</span>
  <span class="n">String</span> <span class="n">referenceId</span><span class="o">,</span> 
  <span class="n">BehaveApiCallback</span><span class="o">&lt;</span><span class="n">LeaderboardScore</span><span class="o">&gt;</span> <span class="n">callback</span>
<span class="o">)</span>
</pre></div>

<ul>
<li>
<strong>Parameters:</strong> </li>
</ul><table>
<thead><tr>
<th>Name</th>
<th align="center">Type</th>
<th align="right">Value</th>
</tr></thead>
<tbody>
<tr>
<td>referenceId</td>
<td align="center">String</td>
<td align="right">
<strong>(Required)</strong> The leaderboard's reference_id (ex: "points")</td>
</tr>
<tr>
<td>callback</td>
<td align="center">BehaveApiCallback</td>
<td align="right">
<strong>(Required)</strong> A callback implementation</td>
</tr>
</tbody>
</table><p>Example:</p>

<div class="highlight highlight-java"><pre><span class="n">Behave</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">getPlayer</span><span class="o">().</span><span class="na">fetchLeaderboardResult</span><span class="o">(</span><span class="s">"points"</span><span class="o">,</span> <span class="k">new</span> <span class="n">BehaveApiCallback</span><span class="o">&lt;</span><span class="n">LeaderboardScore</span><span class="o">&gt;()</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">LeaderboardScore</span> <span class="n">score</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Use results</span>
    <span class="n">Log</span><span class="o">.</span><span class="na">v</span><span class="o">(</span><span class="s">"BehaveExample"</span><span class="o">,</span> <span class="s">"[Position] "</span>    <span class="o">+</span> <span class="n">score</span><span class="o">.</span><span class="na">getPosition</span><span class="o">()</span> <span class="o">+</span> 
                        <span class="s">" | [Score] "</span>       <span class="o">+</span> <span class="n">score</span><span class="o">.</span><span class="na">getScore</span><span class="o">()</span> <span class="o">+</span> 
                        <span class="s">" | [Leaderboard] "</span> <span class="o">+</span> <span class="n">score</span><span class="o">.</span><span class="na">getLeaderboard</span><span class="o">().</span><span class="na">getReferenceId</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Error</span> <span class="n">error</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Handle error</span>
  <span class="o">}</span>  
<span class="o">});</span>
</pre></div>

<h2>
<a name="badges" class="anchor" href="#badges"><span class="octicon octicon-link"></span></a>Badges</h2>

<h3>
<a name="getting-unlocked-badges-of-a-player" class="anchor" href="#getting-unlocked-badges-of-a-player"><span class="octicon octicon-link"></span></a>Getting unlocked badges of a player</h3>

<ul>
<li>
<strong>Method (instance method):</strong> </li>
</ul><div class="highlight highlight-java"><pre><span class="n">Player</span><span class="o">.</span><span class="na">fetchBadges</span><span class="o">(</span>
  <span class="n">BehaveApiCallback</span><span class="o">&lt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">PlayerBadge</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">callback</span>
<span class="o">)</span>
</pre></div>

<ul>
<li>
<strong>Parameters:</strong> </li>
</ul><table>
<thead><tr>
<th>Name</th>
<th align="center">Type</th>
<th align="right">Value</th>
</tr></thead>
<tbody><tr>
<td>callback</td>
<td align="center">BehaveApiCallback&lt; List &gt;</td>
<td align="right">
<strong>(Required)</strong> A callback implementation</td>
</tr></tbody>
</table><p>Example:</p>

<div class="highlight highlight-java"><pre><span class="n">Player</span> <span class="n">player</span> <span class="o">=</span> <span class="n">Behave</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">getPlayer</span><span class="o">();</span>

<span class="n">player</span><span class="o">.</span><span class="na">fetchBadges</span><span class="o">(</span><span class="k">new</span> <span class="n">BehaveApiCallback</span><span class="o">&lt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">PlayerBadge</span><span class="o">&gt;</span> <span class="o">&gt;()</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">PlayerBadge</span><span class="o">&gt;</span> <span class="n">playerBadges</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Use results</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">PlayerBadge</span> <span class="n">playerBadge</span> <span class="o">:</span> <span class="n">playerBadges</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// Get badge</span>
      <span class="n">Badge</span> <span class="n">badge</span> <span class="o">=</span> <span class="n">playerBadge</span><span class="o">.</span><span class="na">getBadge</span><span class="o">();</span>
      <span class="c1">// Get unlocked at Date</span>
      <span class="n">Date</span> <span class="n">unlockedAt</span> <span class="o">=</span> <span class="n">player</span><span class="o">.</span><span class="na">getLastUnlockedAt</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Error</span> <span class="n">error</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Handle error</span>
  <span class="o">}</span>  
<span class="o">});</span>
</pre></div>

<h3>
<a name="getting-locked-badges-of-a-player" class="anchor" href="#getting-locked-badges-of-a-player"><span class="octicon octicon-link"></span></a>Getting locked badges of a player</h3>

<ul>
<li>
<strong>Method (instance method):</strong> </li>
</ul><div class="highlight highlight-java"><pre><span class="n">Player</span><span class="o">.</span><span class="na">fetchLockedBadges</span><span class="o">(</span>
  <span class="n">BehaveApiCallback</span><span class="o">&lt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">PlayerBadge</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">callback</span>
<span class="o">)</span>
</pre></div>

<ul>
<li>
<strong>Parameters:</strong> </li>
</ul><table>
<thead><tr>
<th>Name</th>
<th align="center">Type</th>
<th align="right">Value</th>
</tr></thead>
<tbody><tr>
<td>callback</td>
<td align="center">BehaveApiCallback&lt; List &gt;</td>
<td align="right">
<strong>(Required)</strong> A callback implementation</td>
</tr></tbody>
</table><p>Example:</p>

<div class="highlight highlight-java"><pre><span class="n">Player</span> <span class="n">player</span> <span class="o">=</span> <span class="n">Behave</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">getPlayer</span><span class="o">();</span>

<span class="n">player</span><span class="o">.</span><span class="na">fetchLockedBadges</span><span class="o">(</span><span class="k">new</span> <span class="n">BehaveApiCallback</span><span class="o">&lt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Badge</span><span class="o">&gt;</span> <span class="o">&gt;()</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">success</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Badge</span><span class="o">&gt;</span> <span class="n">badges</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Use results</span>
  <span class="o">}</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">failure</span><span class="o">(</span><span class="n">Error</span> <span class="n">error</span><span class="o">,</span> <span class="n">Response</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Handle error</span>
  <span class="o">}</span>  
<span class="o">});</span>
</pre></div>

<h2>
<a name="listeners" class="anchor" href="#listeners"><span class="octicon octicon-link"></span></a>Listeners</h2>

<p>The JavaScript SDK publishes many events that your app can listen in order to update its state and the UI</p>

<h3>
<a name="adding-a-listener" class="anchor" href="#adding-a-listener"><span class="octicon octicon-link"></span></a>Adding a listener</h3>

<div class="highlight highlight-java"><pre><span class="n">Behave</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">addListener</span><span class="o">(</span><span class="k">new</span> <span class="n">BehaveListener</span><span class="o">()</span> <span class="o">{</span>     
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">identified</span><span class="o">(</span><span class="n">Player</span> <span class="n">player</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Called when your current player is fully identified AND Loaded</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">didUnlockBadge</span><span class="o">(</span><span class="n">Badge</span> <span class="n">badge</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Called when your current player has unlocked a new badge</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">didLevelUp</span><span class="o">(</span><span class="n">Level</span> <span class="n">level</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Called when your current player did just level up</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">didEarnPoints</span><span class="o">(</span><span class="n">Points</span> <span class="n">points</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Called when your current player has earned Points</span>
    <span class="c1">// points.getEarned()</span>
    <span class="c1">// points.getBalance()</span>
  <span class="o">}</span>
<span class="o">});</span>
</pre></div>

<h3>
<a name="removing-a-listener" class="anchor" href="#removing-a-listener"><span class="octicon octicon-link"></span></a>Removing a listener</h3>

<div class="highlight highlight-java"><pre><span class="n">Behave</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">removeListener</span><span class="o">(</span><span class="n">listener</span><span class="o">);</span>
</pre></div>
      </section>
      <footer>
        <p><small>Hosted on <a href="http://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
